#!/bin/bash

# اسکریپت راه‌اندازی خودکار ربات ارز دیجیتال
# این اسکریپت سرور اصلی و برنامه زمان‌بندی را به صورت همزمان اجرا می‌کند

echo "شروع راه‌اندازی ربات ارز دیجیتال..."

# اجرای سرور اصلی در پس‌زمینه
echo "راه‌اندازی سرور اصلی..."
gunicorn --bind 0.0.0.0:5000 --reuse-port --reload main:app &
SERVER_PID=$!
echo "سرور اصلی با PID $SERVER_PID راه‌اندازی شد."

# کمی صبر می‌کنیم تا سرور کاملاً راه‌اندازی شود
sleep 5

# اجرای برنامه زمان‌بندی در پس‌زمینه
echo "راه‌اندازی برنامه زمان‌بندی..."
python scheduler.py &
SCHEDULER_PID=$!
echo "برنامه زمان‌بندی با PID $SCHEDULER_PID راه‌اندازی شد."

echo "راه‌اندازی ربات ارز دیجیتال به پایان رسید."
echo "برای توقف ربات، دستور 'kill $SERVER_PID $SCHEDULER_PID' را اجرا کنید."

# منتظر می‌مانیم تا سرور و زمان‌بندی اجرا شوند
wait