{% extends "minimal_base.html" %}

{% block title %}{{ ui_text('settings', 'ุชูุธูุงุช') }} | {{ ui_text('title', 'ุจุฑุฒู ฺฉุฑูพุชู') }}{% endblock %}

{% block content %}

<div id="notification-settings-content">
    <div class="row mb-4">
        <div class="col-12">
            <h1 class="mb-3">{{ ui_text('settings', 'ุชูุธูุงุช') }}</h1>
            <p class="text-muted">{{ ui_text('settings_description', 'ุชูุธูุงุช ุงุนูุงูโูุงุ ุชูฺฏุฑุงู ู ฺฏุฒุงุฑุดโูุง ุฏูุฑูโุง') }}</p>
        </div>
    </div>

    <div class="row">
        <!-- Main Settings Form -->
        <div class="col-lg-8">
            <form id="notification-settings-form">
                <!-- Language Settings -->
                <div class="card mb-4 crypto-card">
                    <div class="card-header">
                        <h5 class="mb-0">{{ ui_text('language_settings', 'ุชูุธูุงุช ุฒุจุงู') }}</h5>
                    </div>
                    <div class="card-body">
                        <div class="mb-3">
                            <label class="form-label">{{ ui_text('application_language', 'ุฒุจุงู ุจุฑูุงูู') }}</label>
                            <div class="d-flex align-items-center">
                                <a href="/set-language/fa" class="btn btn-outline-primary me-2 {% if session.language == 'fa' or not session.language %}active{% endif %}">
                                    ๐ฎ๐ท ูุงุฑุณ
                                </a>
                                <a href="/set-language/en" class="btn btn-outline-primary me-2 {% if session.language == 'en' %}active{% endif %}">
                                    ๐ฌ๐ง English
                                </a>
                            </div>
                            <div class="small text-muted mt-2">
                                {% if session.language == 'en' %}
                                {{ ui_text('current_language_ltr', 'Current language: English (Left to Right)') }}
                                {% elif session.language == 'fr' %}
                                {{ ui_text('current_language_ltr', 'Langue actuelle: Franรงais (De gauche ร droite)') }}
                                {% else %}
                                {{ ui_text('current_language_rtl', 'ุฒุจุงู ูุนู: ูุงุฑุณ (ุฑุงุณุช ุจู ฺูพ)') }}
                                {% endif %}
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Notification Channels -->
                <div class="card mb-4 crypto-card">
                    <div class="card-header">
                        <h5 class="mb-0">{{ ui_text('notification_channels', 'ฺฉุงูุงูโูุง ุงุนูุงู') }}</h5>
                    </div>
                    <div class="card-body">
                        <div class="row g-3">
                            <div class="col-md-4">
                                <div class="card setting-card h-100">
                                    <div class="card-body">
                                        <div class="form-check form-switch">
                                            <input class="form-check-input" type="checkbox" id="telegram_enabled" name="telegram_enabled" checked>
                                            <label class="form-check-label" for="telegram_enabled">ุชูฺฏุฑุงู</label>
                                        </div>
                                        <p class="text-muted small mt-2">ุฏุฑุงูุช ุงุนูุงูโูุง ู ฺฏุฒุงุฑุดโูุง ุฏุฑ ุชูฺฏุฑุงู</p>
                                        <div class="input-group mt-3">
                                            <span class="input-group-text"><i class="fab fa-telegram"></i></span>
                                            <input type="text" class="form-control" id="telegram_chat_id" name="telegram_chat_id" placeholder="ฺุช ุขุฏ" value="{{ settings.get('telegram_chat_id', '') }}">
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="card setting-card h-100">
                                    <div class="card-body">
                                        <div class="form-check form-switch">
                                            <input class="form-check-input" type="checkbox" id="email_enabled" name="email_enabled">
                                            <label class="form-check-label" for="email_enabled">ุงูู</label>
                                        </div>
                                        <p class="text-muted small mt-2">ุฏุฑุงูุช ฺฏุฒุงุฑุดโูุง ุฑูุฒุงูู ุงุฒ ุทุฑู ุงูู</p>
                                        <div class="input-group mt-3">
                                            <span class="input-group-text"><i class="fas fa-envelope"></i></span>
                                            <input type="email" class="form-control" id="email_address" name="email_address" placeholder="ุขุฏุฑุณ ุงูู" value="{{ settings.get('email_address', '') }}">
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="card setting-card h-100">
                                    <div class="card-body">
                                        <div class="form-check form-switch">
                                            <input class="form-check-input" type="checkbox" id="sms_enabled" name="sms_enabled">
                                            <label class="form-check-label" for="sms_enabled">ูพุงูฺฉ</label>
                                        </div>
                                        <p class="text-muted small mt-2">ุฏุฑุงูุช ูุดุฏุงุฑูุง ููู ุงุฒ ุทุฑู ูพุงูฺฉ</p>
                                        <div class="input-group mt-3">
                                            <span class="input-group-text"><i class="fas fa-sms"></i></span>
                                            <input type="text" class="form-control" id="phone_number" name="phone_number" placeholder="ุดูุงุฑู ููุจุงู" value="{{ settings.get('phone_number', '') }}">
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Notification Types -->
                <div class="card mb-4 crypto-card">
                    <div class="card-header">
                        <h5 class="mb-0">{{ ui_text('notification_types', 'ุงููุงุน ุงุนูุงูโูุง') }}</h5>
                    </div>
                    <div class="card-body">
                        <div class="row g-3">
                            <div class="col-md-4">
                                <div class="card setting-card h-100">
                                    <div class="card-body">
                                        <div class="form-check form-switch">
                                            <input class="form-check-input" type="checkbox" id="price_alerts_enabled" name="price_alerts_enabled" checked>
                                            <label class="form-check-label" for="price_alerts_enabled">ูุดุฏุงุฑูุง ููุช</label>
                                        </div>
                                        <p class="text-muted small mt-2">ุงุนูุงู ุชุบุฑุงุช ููุช ุจุด ุงุฒ ุญุฏ ูุดุฎุต</p>
                                        <div class="input-group mt-3">
                                            <span class="input-group-text">%</span>
                                            <input type="number" class="form-control" id="price_change_threshold" name="price_change_threshold" min="1" max="50" value="{{ settings.get('price_change_threshold', 5) }}">
                                            <span class="input-group-text">ุชุบุฑ</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="card setting-card h-100">
                                    <div class="card-body">
                                        <div class="form-check form-switch">
                                            <input class="form-check-input" type="checkbox" id="signals_enabled" name="signals_enabled" checked>
                                            <label class="form-check-label" for="signals_enabled">ุณฺฏูุงูโูุง ูุนุงููุงุช</label>
                                        </div>
                                        <p class="text-muted small mt-2">ุฏุฑุงูุช ุณฺฏูุงูโูุง ุฎุฑุฏ ู ูุฑูุด</p>
                                        <div class="mt-3">
                                            <select class="form-select" id="signals_frequency" name="signals_frequency">
                                                <option value="all" {% if settings.get('signals_frequency') == 'all' %}selected{% endif %}>ุชูุงู ุณฺฏูุงูโูุง</option>
                                                <option value="strong" {% if settings.get('signals_frequency') == 'strong' %}selected{% endif %}>ููุท ุณฺฏูุงูโูุง ูู</option>
                                                <option value="confirmed" {% if settings.get('signals_frequency') == 'confirmed' %}selected{% endif %}>ููุท ุณฺฏูุงูโูุง ุชุงุฏ ุดุฏู</option>
                                            </select>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="card setting-card h-100">
                                    <div class="card-body">
                                        <div class="form-check form-switch">
                                            <input class="form-check-input" type="checkbox" id="news_alerts_enabled" name="news_alerts_enabled" checked>
                                            <label class="form-check-label" for="news_alerts_enabled">ุงุฎุจุงุฑ ููู</label>
                                        </div>
                                        <p class="text-muted small mt-2">ุฏุฑุงูุช ุงุฎุจุงุฑ ููู ู ุชุงุซุฑฺฏุฐุงุฑ ุจุฑ ุจุงุฒุงุฑ</p>
                                        <div class="mt-3">
                                            <select class="form-select" id="news_sources" name="news_sources">
                                                <option value="all" {% if settings.get('news_sources') == 'all' %}selected{% endif %}>ููู ููุงุจุน ุฎุจุฑ</option>
                                                <option value="major" {% if settings.get('news_sources') == 'major' %}selected{% endif %}>ููุท ููุงุจุน ูุนุชุจุฑ</option>
                                                <option value="verified" {% if settings.get('news_sources') == 'verified' %}selected{% endif %}>ููุท ุงุฎุจุงุฑ ุชุงุฏ ุดุฏู</option>
                                            </select>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Report Schedule -->
                <div class="card mb-4 crypto-card">
                    <div class="card-header">
                        <h5 class="mb-0">{{ ui_text('report_schedule', 'ุฒูุงูโุจูุฏ ฺฏุฒุงุฑุดโูุง ุฏูุฑูโุง') }}</h5>
                    </div>
                    <div class="card-body">
                        <div class="row g-3">
                            <div class="col-md-4">
                                <div class="card setting-card h-100">
                                    <div class="card-body">
                                        <div class="form-check form-switch">
                                            <input class="form-check-input" type="checkbox" id="daily_report_enabled" name="daily_report_enabled" checked>
                                            <label class="form-check-label" for="daily_report_enabled">ฺฏุฒุงุฑุด ุฑูุฒุงูู</label>
                                        </div>
                                        <p class="text-muted small mt-2">ุฎูุงุตู ูุถุนุช ุจุงุฒุงุฑ ู ุชุญูู ุฑูุฒุงูู</p>
                                        <div class="mt-3">
                                            <select class="form-select" id="daily_report_time" name="daily_report_time">
                                                <option value="8:00">ธ:ฐฐ ุตุจุญ</option>
                                                <option value="12:00">ฑฒ:ฐฐ ุธูุฑ</option>
                                                <option value="16:00" selected>ฑถ:ฐฐ ุนุตุฑ</option>
                                                <option value="20:00">ฒฐ:ฐฐ ุดุจ</option>
                                            </select>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="card setting-card h-100">
                                    <div class="card-body">
                                        <div class="form-check form-switch">
                                            <input class="form-check-input" type="checkbox" id="weekly_report_enabled" name="weekly_report_enabled" checked>
                                            <label class="form-check-label" for="weekly_report_enabled">ฺฏุฒุงุฑุด ููุชฺฏ</label>
                                        </div>
                                        <p class="text-muted small mt-2">ุชุญูู ุฌุงูุน ููุชฺฏ ู ูพุดโุจู</p>
                                        <div class="mt-3">
                                            <select class="form-select" id="weekly_report_day" name="weekly_report_day">
                                                <option value="0">ฺฉุดูุจู</option>
                                                <option value="1">ุฏูุดูุจู</option>
                                                <option value="4" selected>ูพูุฌโุดูุจู</option>
                                                <option value="5">ุฌูุนู</option>
                                            </select>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="card setting-card h-100">
                                    <div class="card-body">
                                        <div class="form-check form-switch">
                                            <input class="form-check-input" type="checkbox" id="realtime_updates_enabled" name="realtime_updates_enabled" checked>
                                            <label class="form-check-label" for="realtime_updates_enabled">ุจุฑูุฒุฑุณุงู ูุญุธูโุง</label>
                                        </div>
                                        <p class="text-muted small mt-2">ุงุฑุณุงู ุจุฑูุฒุฑุณุงูโูุง ููู ุฏุฑ ูุญุธู</p>
                                        <div class="mt-3">
                                            <select class="form-select" id="update_frequency" name="update_frequency">
                                                <option value="30">ูุฑ ณฐ ุฏููู</option>
                                                <option value="60" selected>ูุฑ ฑ ุณุงุนุช</option>
                                                <option value="120">ูุฑ ฒ ุณุงุนุช</option>
                                                <option value="240">ูุฑ ด ุณุงุนุช</option>
                                            </select>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Form Buttons -->
                <div class="d-flex justify-content-between">
                    <button type="reset" class="btn btn-outline-secondary">ุจุงุฒูุดุงู</button>
                    <button type="submit" class="btn btn-primary">ุฐุฎุฑู ุชูุธูุงุช</button>
                </div>
            </form>
        </div>
        
        <!-- Sidebar -->
        <div class="col-lg-4 mt-4 mt-lg-0">
            <!-- System Controls -->
            <div class="card mb-4 crypto-card">
                <div class="card-header">
                    <h5 class="mb-0">{{ ui_text('system_controls', 'ฺฉูุชุฑู ุณุณุชู') }}</h5>
                </div>
                <div class="card-body">
                    <p class="text-muted">{{ ui_text('system_controls_desc', 'ูุฏุฑุช ุณุฑูุณโูุง ุฑุจุงุช ู ุฑุงูโุงูุฏุงุฒ ฺฏุฒุงุฑุดโุฏู ุฎูุฏฺฉุงุฑ') }}</p>
                    
                    <div class="form-check form-switch mb-3">
                        <input class="form-check-input" type="checkbox" id="system_monitor_enabled" name="system_monitor_enabled" checked>
                        <label class="form-check-label" for="system_monitor_enabled">{{ ui_text('system_monitoring', 'ุณุณุชู ูุงูุชูุฑูฺฏ ุฑูุดู/ุฎุงููุด') }}</label>
                        <p class="text-muted small mt-1">{{ ui_text('system_monitoring_desc', 'ุงุฑุณุงู ฺฏุฒุงุฑุด ุจู ุชูฺฏุฑุงู ููฺฏุงู ุฑูุดู ุง ุฎุงููุด ุดุฏู ุณุณุชู') }}</p>
                    </div>
                    
                    <div class="d-grid gap-2">
                        <button type="button" id="start-scheduler-button" class="btn btn-success mb-2">
                            <i class="fas fa-play me-2"></i> {{ ui_text('start_auto_scheduler', 'ุฑุงูโุงูุฏุงุฒ ุฒูุงูโุจูุฏ ุฎูุฏฺฉุงุฑ') }}
                        </button>
                        <button type="button" id="stop-scheduler-button" class="btn btn-danger mb-2">
                            <i class="fas fa-stop me-2"></i> {{ ui_text('stop_auto_scheduler', 'ุชููู ุฒูุงูโุจูุฏ ุฎูุฏฺฉุงุฑ') }}
                        </button>
                        <a href="/update_notification_settings" class="btn btn-outline-info mb-2" target="_blank">
                            <i class="fas fa-external-link-alt me-2"></i> {{ ui_text('test_api_browser', 'ุชุณุช API ุฏุฑ ูุฑูุฑฺฏุฑ') }}
                        </a>
                        <a href="/voice-notification" class="btn btn-outline-secondary mb-2">
                            <i class="fas fa-volume-up me-2"></i> {{ ui_text('multilingual_voice_notifications', 'ุงุนูุงูโูุง ุตูุช ฺูุฏุฒุจุงูู') }}
                        </a>
                        <hr>
                        <button type="button" id="test-telegram-button" class="btn btn-outline-primary mb-2">
                            <i class="fab fa-telegram me-2"></i> {{ ui_text('test_telegram', 'ุชุณุช ุชูฺฏุฑุงู') }}
                        </button>
                        <button type="button" id="test-email-button" class="btn btn-outline-secondary mb-2">
                            <i class="fas fa-envelope me-2"></i> {{ ui_text('test_email', 'ุชุณุช ุงูู') }}
                        </button>
                        <button type="button" id="test-sms-button" class="btn btn-outline-secondary">
                            <i class="fas fa-sms me-2"></i> {{ ui_text('test_sms', 'ุชุณุช ูพุงูฺฉ') }}
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- Telegram Bot Setup -->
            <div class="card mb-4 crypto-card">
                <div class="card-header">
                    <h5 class="mb-0">{{ ui_text('telegram_bot_setup', 'ุฑุงูููุง ุชูุธู ุฑุจุงุช ุชูฺฏุฑุงู') }}</h5>
                </div>
                <div class="card-body">
                    <ol class="ps-3">
                        <li class="mb-2">{{ ui_text('telegram_bot_step1', 'ุจู ุฑุจุงุช') }} <a href="https://t.me/{{ bot_username }}" target="_blank">@{{ bot_username }}</a> {{ ui_text('telegram_bot_step1_cont', 'ูพุงู ุฏูุฏ') }}</li>
                        <li class="mb-2">{{ ui_text('telegram_bot_step2', 'ุฏุณุชูุฑ') }} <code>/start</code> {{ ui_text('telegram_bot_step2_cont', 'ุฑุง ุงุฑุณุงู ฺฉูุฏ') }}</li>
                        <li class="mb-2">{{ ui_text('telegram_bot_step3', 'ุฏุณุชูุฑ') }} <code>/id</code> {{ ui_text('telegram_bot_step3_cont', 'ุฑุง ุจุฑุง ุฏุฑุงูุช ฺุช ุขุฏ ุงุฑุณุงู ฺฉูุฏ') }}</li>
                        <li>{{ ui_text('telegram_bot_step4', 'ฺุช ุขุฏ ุฏุฑุงูุช ุฑุง ุฏุฑ ููุฏ ูุฑุจูุทู ุฏุฑ ูุณูุช ุชูุธูุงุช ุชูฺฏุฑุงู ูุงุฑุฏ ฺฉูุฏ') }}</li>
                    </ol>
                    <div class="alert alert-info mt-3">
                        <i class="fas fa-info-circle me-2"></i>
                        {{ ui_text('telegram_chat_id_info', 'ฺุช ุขุฏ ฺฉ ุนุฏุฏ ููุญุตุฑุจูุฑุฏ ุจุฑุง ูุฑ ฺฉุงุฑุจุฑ ุฏุฑ ุชูฺฏุฑุงู ุงุณุช. ุฑุจุงุช ุจุง ุงุณุชูุงุฏู ุงุฒ ุงู ุดูุงุณูุ ูพุงูโูุง ุงุฎุชุตุงุต ุฑุง ุจุฑุง ุดูุง ุงุฑุณุงู ูโฺฉูุฏ.') }}
                    </div>
                </div>
            </div>
            
            <!-- Status Info -->
            <div class="card crypto-card">
                <div class="card-header">
                    <h5 class="mb-0">{{ ui_text('system_status', 'ูุถุนุช ุณุณุชู') }}</h5>
                </div>
                <div class="card-body">
                    <ul class="list-group list-group-flush">
                        <li class="list-group-item d-flex justify-content-between align-items-center bg-transparent">
                            {{ ui_text('bot_status', 'ูุถุนุช ุฑุจุงุช') }}
                            <span class="badge bg-success rounded-pill">{{ ui_text('active', 'ูุนุงู') }}</span>
                        </li>
                        <li class="list-group-item d-flex justify-content-between align-items-center bg-transparent">
                            {{ ui_text('last_update', 'ุขุฎุฑู ุจุฑูุฒุฑุณุงู') }}
                            <span>{{ now.strftime('%H:%M:%S') }}</span>
                        </li>
                        <li class="list-group-item d-flex justify-content-between align-items-center bg-transparent">
                            {{ ui_text('market_api_status', 'ูุถุนุช API ุจุงุฒุงุฑ') }}
                            <span class="badge bg-success rounded-pill">{{ ui_text('connected', 'ูุชุตู') }}</span>
                        </li>
                        <li class="list-group-item d-flex justify-content-between align-items-center bg-transparent">
                            {{ ui_text('bot_mode', 'ุญุงูุช ุฑุจุงุช') }}
                            <span class="badge bg-primary rounded-pill">{{ ui_text('smart', 'ููุดููุฏ') }}</span>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}
