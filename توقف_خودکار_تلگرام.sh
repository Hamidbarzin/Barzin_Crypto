#!/bin/bash
#
# ุงุณฺฉุฑูพุช ุชููู ุณุฑูุณ ุฎูุฏฺฉุงุฑ ุชูฺฏุฑุงู ฺฉุฑูพุชู ุจุฑุฒู
# =================================================
#
# ุงู ุงุณฺฉุฑูพุช ุจุฑุง ุชููู ุณุฑูุณ ุฎูุฏฺฉุงุฑ ุงุฑุณุงู ูพุงูโูุง ุชูฺฏุฑุงู ุทุฑุงุญ ุดุฏู ุงุณุช.
# ูุฏู ุงุตู ุขู ุณุงุฏฺฏ ฺฉุงุฑุจุฑ ุจุฑุง ฺฉุงุฑุจุฑุงู ุงุณุช ู ูุงุฒ ุจู ุฏุงูุด ูู ุฑุง ฺฉุงูุด ูโุฏูุฏ.
#

echo "--------------------------------------------"
echo "๐ ุชููู ุณุฑูุณ ุชูฺฏุฑุงู - ฺฉุฑูพุชู ุจุฑุฒู"
echo "--------------------------------------------"
echo

# ุจุฑุฑุณ ฺฉู ุขุง ุณุฑูุณ ุฏุฑ ุญุงู ุงุฌุฑุงุณุช ุง ุฎุฑ
if ! curl -s localhost:5000/api/telegram/status | grep -q '"running": true'; then
    echo "โ ุณุฑูุณ ุชูฺฏุฑุงู ุฏุฑ ุญุงู ุงุฌุฑุง ูุณุช."
    echo "ุจุฑุง ุฑุงูโุงูุฏุงุฒ ุณุฑูุณุ ุงุฒ ุฏุณุชูุฑ ุฒุฑ ุงุณุชูุงุฏู ฺฉูุฏ:"
    echo "./ุงุฌุฑุง_ุฎูุฏฺฉุงุฑ_ุชูฺฏุฑุงู.sh"
    exit 1
fi

# ุฏุฑุงูุช ูุถุนุช ูุนู
echo "๐ ุจุฑุฑุณ ูุถุนุช ูุนู ุณุฑูุณ..."
curl -s localhost:5000/api/telegram/status
echo 

# ุชูุงุด ุจุฑุง ุชููู ุณุฑูุณ
echo "๐ซ ุฏุฑ ุญุงู ุชููู ุณุฑูุณ ุชูฺฏุฑุงู..."
RESULT=$(curl -s localhost:5000/api/telegram/stop)

# ุจุฑุฑุณ ูุชุฌู
if echo "$RESULT" | grep -q '"success": true'; then
    echo "โ ุณุฑูุณ ุชูฺฏุฑุงู ุจุง ููููุช ูุชููู ุดุฏ."
    echo 
    echo "๐น ุจุฑุง ุฑุงูโุงูุฏุงุฒ ูุฌุฏุฏ ุณุฑูุณ ุงุฒ ุฏุณุชูุฑ ุฒุฑ ุงุณุชูุงุฏู ฺฉูุฏ:"
    echo "๐น ./ุงุฌุฑุง_ุฎูุฏฺฉุงุฑ_ุชูฺฏุฑุงู.sh"
    echo 
    echo "๐ ุจุฑุง ุงุทูุงุนุงุช ุจุดุชุฑุ ุฑุงูููุง_ุชูฺฏุฑุงู.md ุฑุง ูุทุงูุนู ฺฉูุฏ."
else
    echo "โ ุฎุทุง ุฏุฑ ุชููู ุณุฑูุณ ุชูฺฏุฑุงู."
    echo 
    echo "ูพุงุณุฎ ุณุฑูุฑ:"
    echo "$RESULT"
fi

echo
echo "ุจุฑุง ูุดุงูุฏู ูพูู ฺฉูุชุฑู ุชูฺฏุฑุงูุ ุจู ุขุฏุฑุณ ุฒุฑ ูุฑุงุฌุนู ฺฉูุฏ:"
echo "http://localhost:5000/telegram_control_panel"
echo